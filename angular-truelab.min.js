/*! angular-truelab - v0.0.0 - 2014-06-26 16:41 */
!function(window,angular,undefined){"use strict";angular.module("truelab",["truelab._","truelab.loadImage","truelab.debounce"]),angular.module("truelab._",[]).constant("_",window._),angular.module("truelab.debounce",[]).directive("tlDebounce",["$timeout",function(a){var b={delay:1e3};return{restrict:"A",require:"ngModel",priority:99,link:function(c,d,e,f){if("radio"!==e.type&&"checkbox"!==e.type){d.unbind("input");var g,h,i;d.bind("input",function(){i=c.$eval(e.tlDebounce),h=i?i:0===i||"0"===i?i:b.delay,a.cancel(g),h?g=a(function(){c.$apply(function(){f.$setViewValue(d.val())})},h):c.$apply(function(){f.$setViewValue(d.val())})}),d.bind("blur",function(){c.$apply(function(){f.$setViewValue(d.val())})})}}}}]),angular.module("truelab.loadImage",["ng"]).factory("$$image",function(){return{$new:function(){return new window.Image}}}).factory("$tlLoadImage",["$timeout","$q","$$image",function(a,b,c){return{load:function(a,d){var e=this,f=b.defer(),g=c.$new();return g.onload=function(){e.__fn(g,d,f,"resolve")},g.onerror=function(){e.__fn(g,d,f,"reject")},g.src=a,f.promise},loadAll:function(a){var c=[],d=this;return angular.forEach(a,function(a){c.push(d.load(a))}),b.all(c)},__fn:function(b,c,d,e){angular.isDefined(c)&&0!==c?a(function(){d[e](b)},c||0):d[e](b)}}}]).value("$tlLoadImageOptions",{delay:0,css:{base:"tl-load-image",loading:"loading",error:"error"}}).directive("tlLoadImage",["$tlLoadImage","$tlLoadImageOptions",function(a,b){function c(a,b,c){angular.forEach(a.prop("attributes"),function(a){angular.isArray(c)?c.indexOf(a.name)<0&&b.attr(a.name,a.value):b.attr(a.name,a.value)})}function d(a,b){return"tlLoadImage:"+a+(b?":"+b:"")}return{restrict:"EA",replace:!1,scope:!0,link:function(e,f,g){var h=e.$eval(g.tlLoadImageOptions)||{},i=f.children("img");h=angular.extend({},b,h),f.addClass(h.css.base),f.children("img").remove(),e.$watch(g.tlLoadImageOptions,function(a){angular.isObject(a)&&(h=angular.extend({},b,a))},!0),e.$watch(g.tlLoadImage,function(b){b&&(e.$emit(d("pending",h.eventId)),f.removeClass(h.css.error).addClass(h.css.loading),a.load(b,h.delay||0).then(function(a){var b=angular.element(a);c(i,b,["src","ng-src","tl-load-image"]),f.children("img").length>0?f.children("img").replaceWith(b):f.append(b)}).catch(function(){f.addClass(h.css.error)}).finally(function(){f.removeClass(h.css.loading),e.$emit(d("finally",h.eventId))}))})}}}]),angular.module("truelab.loadImage.mock",[]).factory("$$image",function(){var a=function(){};return a.prototype={src:undefined,onload:angular.noop,onerror:angular.noop},{$new:function(){var b=new a;return this.$$images.push(b),b},flush:function(a){var b=this.$$images.shift();a?b.onerror.call(b):b.onload.call(b)},$$images:[]}})}(window,angular);